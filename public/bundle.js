(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports=[
  {
    "text": "Lucidity is a persona-based work of magical realism inspired by my time in the mysterious Pacific Northwest. It updates each and every day. <br /><br />You can reach me at <a href=\"mailto:northernlucidity@gmail.com\"> northernlucidity@gmail.com</a>. I&#8217;d love to hear from you. No, really. I would."
  },
  {
    "text": "I have moved out of my mother&#8217;s house and into an apartment many thousand miles to the north. I will surely miss the comforts of home, but my apartment has its own charms. It has an electric stove. The toilet seat is not cold in the morning. The bedroom is fit for a king, and only locks from the inside. There are a great many windows. There is even a dumbwaiter."
  },
  {
    "text": "I&#8217;ve always had dandruff trouble, but prescription shampoo and rigorous hygiene have kept it in check. Lately, it&#8217;s propagated beyond control. Skin wriggles off my scalp, down my neck, down my face, and I scrape it away with my fingertips. My scalp bleeds. The next day, I scratch at the tingle, and my nails come away with bits of dried blood and gnarled scabs. I lie in the bath, my nose just above the tepid water, and mourn my loss."
  },
  {
    "text": "I&#8217;ve always wanted a cat of my own. I grew up with a profusion of cats &#8212; cats on the sofa, cats in the windows, cats in the shower. But I haven&#8217;t had a cat since moving out. To have a cat is a great responsibility, and my brittle spine would surely buckle under the pressure. So I sit here by my window, gazing at the neighbor&#8217;s yard, watching him play with his little calico kitten. A vicarious cat is better than none."
  },
  {
    "text": "My apartment is small. It&#8217;s a townhouse, part of a small complex. It may be nice, but the eastern windows face a row of real houses. Every day as I wash my carrots, I look at the neighbors&#8217; houses, with their laughing children and kittens and white picket fences and dainty gardens, and a little knot of envy curls around my throat. So I scrub my carrots, methodically, one after the next. I pretend they are the fingers of my neighbors, and I bite their tips, savoring the crisp crackle on my lips. This is my catharsis."
  },
  {
    "text": "I have a computer, but I don&#8217;t plug it in. That is a lie. I don&#8217;t have a computer, but I have a large monitor and a keyboard and a mouse and a case, and when I have visitors, they will think that I have a computer. I clean it religiously. I don&#8217;t have a television. If anyone asks, I will tell them that I watch movies on my computer. This, of course, will be a lie, but an understandable one."
  },
  {
    "text": "My dandruff problem has resolved itself. I knew it was only a matter of time. I can now wear my black shirt with impunity. It is a lovely shirt, and I am glad to reintroduce it to my wardrobe. Perhaps I will wear it tomorrow."
  },
  {
    "text": "In the morning, I see the sun rise between my neighbors&#8217; houses. It gently floats from the horizon, bathing my room in a mellow ocher glow, and I know that a new day is upon me. But in the evening, the woods behind my house swallow the sun before it can set. I never know if the day is done. What if it continues into the night, into the next day? What if the days never end?"
  },
  {
    "text": "I wrote a book last night. It was an autobiography of the highest caliber, touching on each day from my birth to my inevitable death. I set the manuscript alight, breathing in the fumes of my hopes and dreams until the paper crumbled into dust and the flame put itself to sleep. My dreams are in my lungs now. They are little specks of black and char, just waiting for the right moment to appear. Each time I exhale, I bring them one step closer to reality."
  },
  {
    "text": "My apartment does not have a dumbwaiter. This was a painful revelation. I called up my landlord as soon as I realized, but he was unwilling to help. He said none of the apartments in this complex have ever had dumbwaiters, and none ever shall. I told him that the dumbwaiter was the sole reason I selected this complex, but he seemed unfazed. He bid me a good night and left me standing by the phone in silent indignation."
  },
  {
    "text": "There is a twenty-four hour farmers&#8217; market down the street from my apartment. It has no cashiers or attendants. You take what you need and leave cash in a little gray box. I went inside once, but uncertainty wrapped around me like an ocean and I had to leave. I do not like that place."
  },
  {
    "text": "I do enjoy oceans, and they are all around me up here. There is an ocean to the north, where the old people go to walk their dogs. Some nights I go there and gaze at the stars. There is an ocean to the east, and it is fully commercialized. Ferries come and go, and sailboats bob around the waves like ill-formed geese. This is the happiest ocean."
  },
  {
    "text": "My kitchenette is well-stocked. I am proud of my cooking, and refuse to skimp when it comes to cutlery and crockery and the like. I have a set of cast-iron pots and pans, and keep them fully seasoned. I use a variety of oils &#8212; I would not like my pans to grow bored. I also have a set of Zwilling kitchen knives, which I store in a polished bamboo block. Sometimes I lay them out on a placemat and bask in their gleam. Then I put them back."
  },
  {
    "text": "Near the twenty-four hour farmers&#8217; market is a sign that says DUCK EGGS. I walk this area with great caution, but have never seen any eggs. Perhaps they are waiting for me to lower my guard. Perhaps the wolf is crying wolf, and when I have fully disregarded the sign, I will fail to duck the eggs. I will never lower my guard."
  },
  {
    "text": "When I was a child, my mother said that intelligent people never got bored. One day, I complained to her that I was bored. She sighed, and told me that she had suspected as much. She told me not to worry, though. My father was a bit slow as well, and he led a highly successful life. There was hope for me yet. I listened to my mother and didn&#8217;t worry. But perhaps I should have."
  },
  {
    "text": "Behind my apartment is a great expanse of woods. There is a trail leading into them, but this trail is not meant to be walked. These woods are dark. They loom above my apartment, swaying mesmerically, inviting me in, creaking with anticipation. I will not be beguiled. I saw a deer enter these woods once, and it has not returned."
  },
  {
    "text": "I often hear music in my dreams. I hear violin symphonies with wistful trumpet solos; I hear smooth saxophone jazz with a soul-soothing bass-line. In the morning, I wake refreshed, and poetry flows from my fingertips. These are the best mornings. But last night I dreamed of bagpipes, and I can write nothing but limericks."
  },
  {
    "text": "As it turns out, my apartment is not free. It is, in fact, almost seven hundred dollars a month. I am not sure why this was made so unclear on the contract, but what&#8217;s done is done. I had enough for August, but I am now in dire need of money. Perhaps I will seek employment. Perhaps I will run away."
  },
  {
    "text": "Sometimes I miss my mother. I write myself post-it notes to assuage the heartache. I stick them on the bathroom mirror, just like she used to do: <em>Just look at yourself. Is that a face you can respect?</em> Or sometimes: <em>I&#8217;m so glad I have the cats to keep me company.</em>"
  },
  {
    "text": "I ran out of food yesterday and didn&#8217;t have any money for groceries. I went to the twenty-four hour farmer&#8217;s market. Walking toward the door was a journey through molasses, but my moaning stomach drove me forward. I made it inside but could barely see past the throbbing of my eyeballs and the dancing dust in my skull. I grabbed a bunch of carrots and ran all the way home."
  },
  {
    "text": "The carrots were actually radishes. I ate radishes for breakfast, and went downtown to seek employment this morning. A church hired me as a janitor. I asked if I could have my first paycheck in advance, but my interviewer politely declined me. He said they have a soup kitchen on Wednesday afternoons, and welcomed me to come. I&#8217;m glad I grabbed a lot of radishes."
  },
  {
    "text": "The sun is starting to rise later and later. It was imperceptible at first, but I no longer wake to that gentle ocher glow. I wake to the darkness. Perhaps the sun will stop rising soon. Perhaps I will stop waking."
  },
  {
    "text": "I began work as a janitor today. I work in the evening, after all the church-goers have headed home. I am alone with Jesus in the church. He watches me as I sweep the floors. He watches me as I shine the pews. I have always loved Jesus, but I do not think this is my Jesus. My Jesus is an unobtrusive fellow, and has no inclination to scrutinize my labors. I am not sure I will last long here."
  },
  {
    "text": "A cat found its way into my apartment. I don&#8217;t know how. The door was locked and the windows were shut and the roof was firmly in place. I did not know what to do. I wanted to love the cat, to hold it and pet it, to cradle its little paws and fill its belly with sardines, but I knew that could never happen. So I ran myself a bath, and I lay there and let my confusion diffuse into the water."
  },
  {
    "text": "I went to the soup kitchen this afternoon. It was the strangest ritual. There were many unkempt men and women, but they seemed in good spirits. The cooks wore silly hats, which seemed wholly unnecessary. I was given a small paper bowl. A cook ladled it full of cream-of-radish soup, which I did not know even existed. I think the cook was mocking me. I will not be returning any time soon."
  },
  {
    "text": "When I went downstairs this morning, I noticed a small row of pine trees in my dining room. They were small &#8212; no more than four inches tall. This made their behavior no more acceptable, though. I am sure this was the work of the woods. I plucked them immediately and tossed them down the garbage disposal, elating in the sound of grinding sap. The forest needs to be kept in its place."
  },
  {
    "text": "My neighbor&#8217;s calico is feisty. She got in a fight with a grumpy old tomcat and didn&#8217;t even seem fazed. She batted his nose with both paws like it was a speed bag, then finished him off with a swift blow to the temple. How delightfully embarrassing! I&#8217;ve grow quite fond of this calico. I think I will call her Zeetha."
  },
  {
    "text": "There&#8217;s a coffee shop on the eastern shore. I go there from time to time. I sit by the window, watching the sailboats sway in the cool ocean breeze. Sometimes flocks of gulls come by, plunging under the waves in search of lunch. Sometimes they come up with fish, sometimes without. One gull didn&#8217;t come up. I think the gulls are a metaphor."
  },
  {
    "text": "I encountered a hobo on the way to work today. He spoke the sky to me. His breath floated lazy clouds, and his whistle sent songbirds soaring across them. His voice &#8212; a clear golden tenor &#8212; bathed us in sunlight, and I basked in his soundscape for time untold. I gave him a radish."
  },
  {
    "text": "That cat is still in my apartment. I&#8217;m still not comfortable with the notion, but he is surprisingly self-sufficient. It seems he made himself a peanut butter sandwich while I was away, but he didn&#8217;t clean his dishes. I suppose I will have to teach him proper household etiquette soon."
  },
  {
    "text": "Beyond all else, I am proud of my culinary talents. Still, a week&#8217;s worth of radishes has pushed the bounds of my creativity. I&#8217;ve had baked radishes and boiled radishes, radish sandwiches and faux-pickled radishes. I have scoured the streets for other ingredients; I have made rhubarb-radish salads, blackberry-radish smoothies, fennel-infused radish foams. I cannot wait to eat a carrot."
  },
  {
    "text": "Zeetha caught a hummingbird today. She fell upon it like an arrow, snagging the bird&#8217;s wing with her claws and dashing it to the earth. She mewled triumphantly, mauling its little torso with youthful vigor. Then she sauntered off with an iridescent feather mustache and left the broken bird writhing on the dirt. Zeetha is a very good cat."
  },
  {
    "text": "Deer are creatures of twilight. I counted nine on my way home from work. One stood in the road. A doe and three fawns grazed the graveyard. There was one on my neighbor&#8217;s roof. It seemed concerned."
  },
  {
    "text": "I think Jesus enjoys watching me work, but I&#8217;m never too sure. In fact, I&#8217;m never sure at all. I&#8217;m never sure of anything. I&#8217;m trapped in a spiral of doubt and uncertainty, and to be perfectly frank, the thought of Jesus watching me as I sweep between the pews does nothing to assuage my insecurities."
  },
  {
    "text": "I haven&#8217;t spoken to my mother since moving up north. I will have to call her at some point, but I would like to show her that I am doing well for myself. These days, I eat nothing but radishes. That is not the kind of thing she would be proud of."
  },
  {
    "text": "It just dawned on me that I could eat a peanut butter sandwich. The cat made a peanut butter sandwich. Why did I not realize that I had bread and peanut butter? My radish-addled brain has become too weak to process the sight of peanut butter. I will go make myself a sandwich now."
  },
  {
    "text": "There are so many stars up here. They effervesce like fireflies. They dance merrily through the night sky, unaware that each dip and twirl and flicker brings them one step closer to death. What a beautiful existence."
  },
  {
    "text": "I found a wallet today. It was a fat black beast, swollen and distended from ungodly lumps of cash. There was no identification. I suppose Jesus works in mysterious ways. I suppose he approves of my work for the church. I bought myself some carrots."
  },
  {
    "text": "Once again, I stumbled upon a small row of pine trees that had taken root in my house. They were in the kitchen. I introduced most of them to the garbage disposal, but decided to let one grow for a time. Perhaps, if I treat it well, the tree will develop Stockholm syndrome and divulge the forest&#8217;s plans to me."
  },
  {
    "text": "The old lady at the grocery store told me I looked cute. I don&#8217;t want to look cute. I especially do not want to look cute for old ladies. I have decided to develop some stubble and a horrible grimace."
  },
  {
    "text": "Yet another farmers&#8217; market has opened up in town. This one is much nicer than the twenty-four hour farmers market, but cannot compare to the weekly event in the plaza. It is called �Farmers, Ltd.,� and seems to sell farmers instead of produce."
  },
  {
    "text": "It seems that the cat in my house disappeared, just as swiftly and silently as he came. What a mystical creature. He also seems to have absconded with my peanut butter."
  },
  {
    "text": "The wallet I stumbled upon the other day was actually a briefcase. An understandable error, seeing how large and leathery it was. I disemboweled the thing, set aside the intestines, and set the empty carapace alight. It burned blue for hours."
  },
  {
    "text": "I bought rum today. I have never bought rum before. I will never buy rum again. We will not talk about anything else that happened today. Rum is not my friend, and it is not your friend. Rum should stay on the shelf and stew in its own miserable juices."
  },
  {
    "text": "I tried to call my mother today. It seems that she has finally installed an answering machine. It greeted me with a familiar <em>Hello,</em> a perfect emulation of my mother&#8217;s drawl, but when I began speaking, it prompted me to leave a message. It hung up halfway through my message. I think she bought a faulty answering machine."
  },
  {
    "text": "The tree in my kitchen continues to grow. It&#8217;s about ten inches high now, about as thick as a straw at the base. I know it&#8217;s a vile thing, but it&#8217;s really quite pretty. Maybe I can decorate it once Christmas comes around."
  },
  {
    "text": "This is not about me. This is about the ocean. The ocean is all there is, and all there ever will be. Soon, humanity will end. Soon, the continents will end. Only the ocean will remain, and within it, millions of carp and tetra and dolphins and whales will swim about blissfully, never imagining that a world outside the seas once existed."
  },
  {
    "text": "There&#8217;s a young oak outside my room, and woodland animals come from all around to enjoy its youthful presence. Bugs skitter around its lithe trunk, and nuthatches peck them off. Squirrels race each other up and down the tree. A lizard basks in the sun, staring into my eyes and doing pushups. I think he&#8217;s trying to impress me."
  },
  {
    "text": "I called my landlord today and requested that he install a dumbwaiter in my apartment. He flatly refused me, saying there were enough dumb things in my apartment already. I do not like my landlord."
  },
  {
    "text": "Due to incidents I shall not reveal, I had to shave my head. This may be for the better. I seem untouched by dandruff, and am no longer cute. Little old ladies do not bother me in grocery stores. They do not bother me anywhere. They sometimes cross the street to avoid me."
  },
  {
    "text": "I do not think Jesus likes my new look. I could feel his fiery eyes boring into my shiny skull as I swept the floors and dusted the pews today. I would wear a hat, but I know that Jesus does not approve of hats either. He is a most difficult customer."
  },
  {
    "text": "The lizard on the tree outside my room grows bolder. He wore a suit and brought me flowers today. I thanked him for the flowers and smiled and closed the blinds."
  },
  {
    "text": "At night, thousands of tiny insects squirm through the screen on my window and dance around my lights. When I turn them off and head to bed, the bugs swarm my fire alarm. They refract and reflect and diffuse the single green LED, making a pulsing, glowing cloud of ambience that lets me drift to sleep peacefully."
  },
  {
    "text": "My father was a businessman. I do not know what his business was, and I&#8217;m not sure he did either. My father was not an intelligent man. He was kind and warm and charming, though, and mother said he was a social genius. She said everyone was intelligent in their own way, and one day she would figure out how I was intelligent."
  },
  {
    "text": "As I walked home from church this evening, a great murmuration of starlings blotted out the setting sun. Their keen chirps and whistles pitched together in a cacophonic chorus as they danced through the skies, fragile wings beating a desperate rhythm. Dogs and children howled in panic. The world grew dark and loud and frantic and I took shelter in a barbershop, waiting for the birds to grow weary of their juvenile game."
  },
  {
    "text": "I have made an unexpected culinary discovery: peanut butter and radishes. Mix equal parts melted butter and peanut butter, coat the radishes, sprinkle with flake salt, and refrigerate. Small, mild radishes make the best treats. Serve them as upscale hors d&#8217;oeuvres or feed them to the neighbor&#8217;s cat."
  },
  {
    "text": "I took a hike by the seaside after work yesterday. I went down to the old defunct lighthouse and climbed atop its weather-worn wall. The sun slowly sank into the crashing waves far below, and the horizon glowed like a luminescent peach. Darkness settled across the seascape. I watched for a while as moon-crested waves danced into the distance. Then I climbed from the lighthouse and walked home, humming to myself in the starlit night."
  },
  {
    "text": "Zeetha has become a masterful hunter. I have seen her catch two hummingbirds, four starlings, seven lizards, ten radishes, three mice, one squirrel, and one doe. The doe did not care that it had been caught, but Zeetha rode around on its back for some minutes, flexing her battle-hardened claws and mewling triumphantly. Perhaps she will catch a great eagle next and soar off into the vast open skies."
  },
  {
    "text": "I became the wind and shook through the town. I slammed shut the shutters and dusted cobwebs from the eaves. I tossed a frenzy of hats through the streets. I somersaulted the songbirds and buffeted the bees and scattered the seagulls and crows for miles around. I pushed a small child to the asphalt, then dropped a pristine daisy in her hand. I slept soundly that night."
  },
  {
    "text": "Every morning, I am greeted by the sultry gaze of that over-persistent lizard. I have told him time and time again that I am not interested, but he continues to stare into my soul as he flexes his tail this way and that, doing pushups and crunches and handstands and acrobatics of all sorts on the young oak. I am not impressed, and I will never be impressed, and I do not think he comprehends this. The foolish lizard must have an extraordinary sense of self-importance."
  },
  {
    "text": "My little hostage tree has grown to sixteen inches, and is as thick as my pinky at the base. It is hearty and happy. It has a few long, ungainly branches that stick out in all directions. It looks more like modern art than a tree, but I know it is a tree. It is a gangly adolescent tree, and I should not make fun of it. One day it will come into its own."
  },
  {
    "text": "I prefer not to consider the woods behind my apartment, but on occasion I feel obliged to check on them. If left unmonitored, the trees will surely stretch toward civilization, one perverse root at a time. They will pierce through lawns and wrap around fences and squeeze houses into little piles of rubble, and we will be consumed by the woods&#8217; dark lust. So I stand outside my back door with folded arms and a terse brow, and I remind the woods that they are being watched closely."
  },
  {
    "text": "The sound of my own voice has always eluded me, so I went and bought a recorder. I recorded a number of different vocalizations: grandiose oration, slam poetry, casual speech, and opera. Sadly, my record player was unable to play the recordings, so I remain unsure about the quality of my vocal tract."
  },
  {
    "text": "When I was five, my mother sewed wizard costumes for my father and me. They were splendid outfits. We wore majestic purple robes, deep like the night, trimmed with shimmering silver threads and emblazoned with mystical constellations. We waved fine wooden wands that flashed gold and showered the sky in iridescent sparks. My father donned a magnificent white wizarding beard; but I, as his apprentice, was allowed no facial hair. I cried bitterly, but mother would not relent. I did not deserve a beard. "
  },
  {
    "text": "My favorite coffee shop is a quaint little venue with bright mosaic walls and affable baristas. It has a motley collection of wooden chairs and comfy couches. On Wednesday afternoons, it also has a large ensemble of geriatric Irish musicians with harps and bodhrans and penny whistles and fiddles and even a bagpipe and a standing bass. There are about fifteen of them. They sing at the top of their lungs, clapping their desiccated hands and stomping the floor cheerfully. The bagpipe is shrill enough to shatter anyone&#8217;s eardrums, but the tunes are so joyous that no one complains."
  },
  {
    "text": "My neighbor saw me feeding peanut-butter radishes to Zeetha the other day. He was irate. He said that radishes are toxic for felines, that I was overstepping my bounds, and that I should be ashamed of myself. I told my neighbor that while radish greens are poisonous for cats, the root is a healthful treat, and he should be thankful for my attentiveness. He said that if he ever sees me feeding Allie again &#8212; he calls her Allie &#8212; he would report me to the police. He is a cruel man with poor taste in names."
  },
  {
    "text": "The sun was large today. It cast a deep orange pall over the town, an unnatural autumn hue. Uneven violet shadows wobbled across the streets, and the dogs and cats fell into torpor. The crickets and songbirds refused to sing. The sun stood over us for hours, waiting, waiting, but no one went outside."
  },
  {
    "text": "As I child, I never had any collections. My father collected baseball cards, but I found the thought dreary and tedious. Now that I am an adult, it seems appropriate that I have a dreary and tedious hobby of some sort, so I will begin collecting. I do not know what yet. Stamps? Children? Wigs? Taxes?"
  },
  {
    "text": "I awoke this morning to a passionate serenade. It seems the lizard has taken up violin, and he has an unexpected talent for it. Poignant tremolos flitted in through the curtains, enchanting melodies that pulled me gently from my slumber, and I was almost enamored."
  }
]

},{}],2:[function(require,module,exports){
var page = require('page');
var entries = require('./entries.json');
var cap = entries.length - 1;
var currentPage;

document.addEventListener('DOMContentLoaded', function() {
  page('/', logRootRoute);
  page('/test', pageTest);
  page('/:entry', getEntry);
  page('*', somethingElse);
  page();

  document.getElementById('next').addEventListener('click', clickNext);
  document.getElementById('last').addEventListener('click', clickLast);
  document.getElementById('previous').addEventListener('click', clickPrevious);
  document.getElementById('first').addEventListener('click', clickFirst);
})

function logRootRoute(...args) {
  console.log('root!');
}

function getEntry(context, next) {
  var entry = parseInt(context.params.entry);
  if (entry > cap) { entry = cap; }
  if (entry < 0) { entry = 0; }
  currentPage = entry;
  nextEntry(entry);
}

function pageTest() {
  console.log(ctx);

}

function somethingElse(...args) {
  console.log('other!');
}

function nextEntry(entry) {
  var elements = document.getElementsByClassName('text')
  console.log(elements[0]);
  elements[0].innerHTML = entries[entry].text;
}

function clickNext() {
  page('/' + (currentPage + 1));
}

function clickPrevious() {
  page('/' + (currentPage - 1));
}

function clickLast() {
  page('/' + cap);
}

function clickFirst() {
  page('/0');
}

},{"./entries.json":1,"page":4}],3:[function(require,module,exports){
module.exports = Array.isArray || function (arr) {
  return Object.prototype.toString.call(arr) == '[object Array]';
};

},{}],4:[function(require,module,exports){
(function (process){
  /* globals require, module */

  'use strict';

  /**
   * Module dependencies.
   */

  var pathtoRegexp = require('path-to-regexp');

  /**
   * Module exports.
   */

  module.exports = page;

  /**
   * Detect click event
   */
  var clickEvent = ('undefined' !== typeof document) && document.ontouchstart ? 'touchstart' : 'click';

  /**
   * To work properly with the URL
   * history.location generated polyfill in https://github.com/devote/HTML5-History-API
   */

  var location = ('undefined' !== typeof window) && (window.history.location || window.location);

  /**
   * Perform initial dispatch.
   */

  var dispatch = true;


  /**
   * Decode URL components (query string, pathname, hash).
   * Accommodates both regular percent encoding and x-www-form-urlencoded format.
   */
  var decodeURLComponents = true;

  /**
   * Base path.
   */

  var base = '';

  /**
   * Running flag.
   */

  var running;

  /**
   * HashBang option
   */

  var hashbang = false;

  /**
   * Previous context, for capturing
   * page exit events.
   */

  var prevContext;

  /**
   * Register `path` with callback `fn()`,
   * or route `path`, or redirection,
   * or `page.start()`.
   *
   *   page(fn);
   *   page('*', fn);
   *   page('/user/:id', load, user);
   *   page('/user/' + user.id, { some: 'thing' });
   *   page('/user/' + user.id);
   *   page('/from', '/to')
   *   page();
   *
   * @param {string|!Function|!Object} path
   * @param {Function=} fn
   * @api public
   */

  function page(path, fn) {
    // <callback>
    if ('function' === typeof path) {
      return page('*', path);
    }

    // route <path> to <callback ...>
    if ('function' === typeof fn) {
      var route = new Route(/** @type {string} */ (path));
      for (var i = 1; i < arguments.length; ++i) {
        page.callbacks.push(route.middleware(arguments[i]));
      }
      // show <path> with [state]
    } else if ('string' === typeof path) {
      page['string' === typeof fn ? 'redirect' : 'show'](path, fn);
      // start [options]
    } else {
      page.start(path);
    }
  }

  /**
   * Callback functions.
   */

  page.callbacks = [];
  page.exits = [];

  /**
   * Current path being processed
   * @type {string}
   */
  page.current = '';

  /**
   * Number of pages navigated to.
   * @type {number}
   *
   *     page.len == 0;
   *     page('/login');
   *     page.len == 1;
   */

  page.len = 0;

  /**
   * Get or set basepath to `path`.
   *
   * @param {string} path
   * @api public
   */

  page.base = function(path) {
    if (0 === arguments.length) return base;
    base = path;
  };

  /**
   * Bind with the given `options`.
   *
   * Options:
   *
   *    - `click` bind to click events [true]
   *    - `popstate` bind to popstate [true]
   *    - `dispatch` perform initial dispatch [true]
   *
   * @param {Object} options
   * @api public
   */

  page.start = function(options) {
    options = options || {};
    if (running) return;
    running = true;
    if (false === options.dispatch) dispatch = false;
    if (false === options.decodeURLComponents) decodeURLComponents = false;
    if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);
    if (false !== options.click) {
      document.addEventListener(clickEvent, onclick, false);
    }
    if (true === options.hashbang) hashbang = true;
    if (!dispatch) return;
    var url = (hashbang && ~location.hash.indexOf('#!')) ? location.hash.substr(2) + location.search : location.pathname + location.search + location.hash;
    page.replace(url, null, true, dispatch);
  };

  /**
   * Unbind click and popstate event handlers.
   *
   * @api public
   */

  page.stop = function() {
    if (!running) return;
    page.current = '';
    page.len = 0;
    running = false;
    document.removeEventListener(clickEvent, onclick, false);
    window.removeEventListener('popstate', onpopstate, false);
  };

  /**
   * Show `path` with optional `state` object.
   *
   * @param {string} path
   * @param {Object=} state
   * @param {boolean=} dispatch
   * @param {boolean=} push
   * @return {!Context}
   * @api public
   */

  page.show = function(path, state, dispatch, push) {
    var ctx = new Context(path, state);
    page.current = ctx.path;
    if (false !== dispatch) page.dispatch(ctx);
    if (false !== ctx.handled && false !== push) ctx.pushState();
    return ctx;
  };

  /**
   * Goes back in the history
   * Back should always let the current route push state and then go back.
   *
   * @param {string} path - fallback path to go back if no more history exists, if undefined defaults to page.base
   * @param {Object=} state
   * @api public
   */

  page.back = function(path, state) {
    if (page.len > 0) {
      // this may need more testing to see if all browsers
      // wait for the next tick to go back in history
      history.back();
      page.len--;
    } else if (path) {
      setTimeout(function() {
        page.show(path, state);
      });
    }else{
      setTimeout(function() {
        page.show(base, state);
      });
    }
  };


  /**
   * Register route to redirect from one path to other
   * or just redirect to another route
   *
   * @param {string} from - if param 'to' is undefined redirects to 'from'
   * @param {string=} to
   * @api public
   */
  page.redirect = function(from, to) {
    // Define route from a path to another
    if ('string' === typeof from && 'string' === typeof to) {
      page(from, function(e) {
        setTimeout(function() {
          page.replace(/** @type {!string} */ (to));
        }, 0);
      });
    }

    // Wait for the push state and replace it with another
    if ('string' === typeof from && 'undefined' === typeof to) {
      setTimeout(function() {
        page.replace(from);
      }, 0);
    }
  };

  /**
   * Replace `path` with optional `state` object.
   *
   * @param {string} path
   * @param {Object=} state
   * @param {boolean=} init
   * @param {boolean=} dispatch
   * @return {!Context}
   * @api public
   */


  page.replace = function(path, state, init, dispatch) {
    var ctx = new Context(path, state);
    page.current = ctx.path;
    ctx.init = init;
    ctx.save(); // save before dispatching, which may redirect
    if (false !== dispatch) page.dispatch(ctx);
    return ctx;
  };

  /**
   * Dispatch the given `ctx`.
   *
   * @param {Context} ctx
   * @api private
   */
  page.dispatch = function(ctx) {
    var prev = prevContext,
      i = 0,
      j = 0;

    prevContext = ctx;

    function nextExit() {
      var fn = page.exits[j++];
      if (!fn) return nextEnter();
      fn(prev, nextExit);
    }

    function nextEnter() {
      var fn = page.callbacks[i++];

      if (ctx.path !== page.current) {
        ctx.handled = false;
        return;
      }
      if (!fn) return unhandled(ctx);
      fn(ctx, nextEnter);
    }

    if (prev) {
      nextExit();
    } else {
      nextEnter();
    }
  };

  /**
   * Unhandled `ctx`. When it's not the initial
   * popstate then redirect. If you wish to handle
   * 404s on your own use `page('*', callback)`.
   *
   * @param {Context} ctx
   * @api private
   */
  function unhandled(ctx) {
    if (ctx.handled) return;
    var current;

    if (hashbang) {
      current = base + location.hash.replace('#!', '');
    } else {
      current = location.pathname + location.search;
    }

    if (current === ctx.canonicalPath) return;
    page.stop();
    ctx.handled = false;
    location.href = ctx.canonicalPath;
  }

  /**
   * Register an exit route on `path` with
   * callback `fn()`, which will be called
   * on the previous context when a new
   * page is visited.
   */
  page.exit = function(path, fn) {
    if (typeof path === 'function') {
      return page.exit('*', path);
    }

    var route = new Route(path);
    for (var i = 1; i < arguments.length; ++i) {
      page.exits.push(route.middleware(arguments[i]));
    }
  };

  /**
   * Remove URL encoding from the given `str`.
   * Accommodates whitespace in both x-www-form-urlencoded
   * and regular percent-encoded form.
   *
   * @param {string} val - URL component to decode
   */
  function decodeURLEncodedURIComponent(val) {
    if (typeof val !== 'string') { return val; }
    return decodeURLComponents ? decodeURIComponent(val.replace(/\+/g, ' ')) : val;
  }

  /**
   * Initialize a new "request" `Context`
   * with the given `path` and optional initial `state`.
   *
   * @constructor
   * @param {string} path
   * @param {Object=} state
   * @api public
   */

  function Context(path, state) {
    if ('/' === path[0] && 0 !== path.indexOf(base)) path = base + (hashbang ? '#!' : '') + path;
    var i = path.indexOf('?');

    this.canonicalPath = path;
    this.path = path.replace(base, '') || '/';
    if (hashbang) this.path = this.path.replace('#!', '') || '/';

    this.title = document.title;
    this.state = state || {};
    this.state.path = path;
    this.querystring = ~i ? decodeURLEncodedURIComponent(path.slice(i + 1)) : '';
    this.pathname = decodeURLEncodedURIComponent(~i ? path.slice(0, i) : path);
    this.params = {};

    // fragment
    this.hash = '';
    if (!hashbang) {
      if (!~this.path.indexOf('#')) return;
      var parts = this.path.split('#');
      this.path = parts[0];
      this.hash = decodeURLEncodedURIComponent(parts[1]) || '';
      this.querystring = this.querystring.split('#')[0];
    }
  }

  /**
   * Expose `Context`.
   */

  page.Context = Context;

  /**
   * Push state.
   *
   * @api private
   */

  Context.prototype.pushState = function() {
    page.len++;
    history.pushState(this.state, this.title, hashbang && this.path !== '/' ? '#!' + this.path : this.canonicalPath);
  };

  /**
   * Save the context state.
   *
   * @api public
   */

  Context.prototype.save = function() {
    history.replaceState(this.state, this.title, hashbang && this.path !== '/' ? '#!' + this.path : this.canonicalPath);
  };

  /**
   * Initialize `Route` with the given HTTP `path`,
   * and an array of `callbacks` and `options`.
   *
   * Options:
   *
   *   - `sensitive`    enable case-sensitive routes
   *   - `strict`       enable strict matching for trailing slashes
   *
   * @constructor
   * @param {string} path
   * @param {Object=} options
   * @api private
   */

  function Route(path, options) {
    options = options || {};
    this.path = (path === '*') ? '(.*)' : path;
    this.method = 'GET';
    this.regexp = pathtoRegexp(this.path,
      this.keys = [],
      options);
  }

  /**
   * Expose `Route`.
   */

  page.Route = Route;

  /**
   * Return route middleware with
   * the given callback `fn()`.
   *
   * @param {Function} fn
   * @return {Function}
   * @api public
   */

  Route.prototype.middleware = function(fn) {
    var self = this;
    return function(ctx, next) {
      if (self.match(ctx.path, ctx.params)) return fn(ctx, next);
      next();
    };
  };

  /**
   * Check if this route matches `path`, if so
   * populate `params`.
   *
   * @param {string} path
   * @param {Object} params
   * @return {boolean}
   * @api private
   */

  Route.prototype.match = function(path, params) {
    var keys = this.keys,
      qsIndex = path.indexOf('?'),
      pathname = ~qsIndex ? path.slice(0, qsIndex) : path,
      m = this.regexp.exec(decodeURIComponent(pathname));

    if (!m) return false;

    for (var i = 1, len = m.length; i < len; ++i) {
      var key = keys[i - 1];
      var val = decodeURLEncodedURIComponent(m[i]);
      if (val !== undefined || !(hasOwnProperty.call(params, key.name))) {
        params[key.name] = val;
      }
    }

    return true;
  };


  /**
   * Handle "populate" events.
   */

  var onpopstate = (function () {
    var loaded = false;
    if ('undefined' === typeof window) {
      return;
    }
    if (document.readyState === 'complete') {
      loaded = true;
    } else {
      window.addEventListener('load', function() {
        setTimeout(function() {
          loaded = true;
        }, 0);
      });
    }
    return function onpopstate(e) {
      if (!loaded) return;
      if (e.state) {
        var path = e.state.path;
        page.replace(path, e.state);
      } else {
        page.show(location.pathname + location.hash, undefined, undefined, false);
      }
    };
  })();
  /**
   * Handle "click" events.
   */

  function onclick(e) {

    if (1 !== which(e)) return;

    if (e.metaKey || e.ctrlKey || e.shiftKey) return;
    if (e.defaultPrevented) return;



    // ensure link
    // use shadow dom when available
    var el = e.path ? e.path[0] : e.target;
    while (el && 'A' !== el.nodeName) el = el.parentNode;
    if (!el || 'A' !== el.nodeName) return;



    // Ignore if tag has
    // 1. "download" attribute
    // 2. rel="external" attribute
    if (el.hasAttribute('download') || el.getAttribute('rel') === 'external') return;

    // ensure non-hash for the same path
    var link = el.getAttribute('href');
    if (!hashbang && el.pathname === location.pathname && (el.hash || '#' === link)) return;



    // Check for mailto: in the href
    if (link && link.indexOf('mailto:') > -1) return;

    // check target
    if (el.target) return;

    // x-origin
    if (!sameOrigin(el.href)) return;



    // rebuild path
    var path = el.pathname + el.search + (el.hash || '');

    // strip leading "/[drive letter]:" on NW.js on Windows
    if (typeof process !== 'undefined' && path.match(/^\/[a-zA-Z]:\//)) {
      path = path.replace(/^\/[a-zA-Z]:\//, '/');
    }

    // same page
    var orig = path;

    if (path.indexOf(base) === 0) {
      path = path.substr(base.length);
    }

    if (hashbang) path = path.replace('#!', '');

    if (base && orig === path) return;

    e.preventDefault();
    page.show(orig);
  }

  /**
   * Event button.
   */

  function which(e) {
    e = e || window.event;
    return null === e.which ? e.button : e.which;
  }

  /**
   * Check if `href` is the same origin.
   */

  function sameOrigin(href) {
    var origin = location.protocol + '//' + location.hostname;
    if (location.port) origin += ':' + location.port;
    return (href && (0 === href.indexOf(origin)));
  }

  page.sameOrigin = sameOrigin;

}).call(this,require('_process'))
},{"_process":6,"path-to-regexp":5}],5:[function(require,module,exports){
var isarray = require('isarray')

/**
 * Expose `pathToRegexp`.
 */
module.exports = pathToRegexp
module.exports.parse = parse
module.exports.compile = compile
module.exports.tokensToFunction = tokensToFunction
module.exports.tokensToRegExp = tokensToRegExp

/**
 * The main path matching regexp utility.
 *
 * @type {RegExp}
 */
var PATH_REGEXP = new RegExp([
  // Match escaped characters that would otherwise appear in future matches.
  // This allows the user to escape special characters that won't transform.
  '(\\\\.)',
  // Match Express-style parameters and un-named parameters with a prefix
  // and optional suffixes. Matches appear as:
  //
  // "/:test(\\d+)?" => ["/", "test", "\d+", undefined, "?", undefined]
  // "/route(\\d+)"  => [undefined, undefined, undefined, "\d+", undefined, undefined]
  // "/*"            => ["/", undefined, undefined, undefined, undefined, "*"]
  '([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))'
].join('|'), 'g')

/**
 * Parse a string for the raw tokens.
 *
 * @param  {String} str
 * @return {Array}
 */
function parse (str) {
  var tokens = []
  var key = 0
  var index = 0
  var path = ''
  var res

  while ((res = PATH_REGEXP.exec(str)) != null) {
    var m = res[0]
    var escaped = res[1]
    var offset = res.index
    path += str.slice(index, offset)
    index = offset + m.length

    // Ignore already escaped sequences.
    if (escaped) {
      path += escaped[1]
      continue
    }

    // Push the current path onto the tokens.
    if (path) {
      tokens.push(path)
      path = ''
    }

    var prefix = res[2]
    var name = res[3]
    var capture = res[4]
    var group = res[5]
    var suffix = res[6]
    var asterisk = res[7]

    var repeat = suffix === '+' || suffix === '*'
    var optional = suffix === '?' || suffix === '*'
    var delimiter = prefix || '/'
    var pattern = capture || group || (asterisk ? '.*' : '[^' + delimiter + ']+?')

    tokens.push({
      name: name || key++,
      prefix: prefix || '',
      delimiter: delimiter,
      optional: optional,
      repeat: repeat,
      pattern: escapeGroup(pattern)
    })
  }

  // Match any characters still remaining.
  if (index < str.length) {
    path += str.substr(index)
  }

  // If the path exists, push it onto the end.
  if (path) {
    tokens.push(path)
  }

  return tokens
}

/**
 * Compile a string to a template function for the path.
 *
 * @param  {String}   str
 * @return {Function}
 */
function compile (str) {
  return tokensToFunction(parse(str))
}

/**
 * Expose a method for transforming tokens into the path function.
 */
function tokensToFunction (tokens) {
  // Compile all the tokens into regexps.
  var matches = new Array(tokens.length)

  // Compile all the patterns before compilation.
  for (var i = 0; i < tokens.length; i++) {
    if (typeof tokens[i] === 'object') {
      matches[i] = new RegExp('^' + tokens[i].pattern + '$')
    }
  }

  return function (obj) {
    var path = ''
    var data = obj || {}

    for (var i = 0; i < tokens.length; i++) {
      var token = tokens[i]

      if (typeof token === 'string') {
        path += token

        continue
      }

      var value = data[token.name]
      var segment

      if (value == null) {
        if (token.optional) {
          continue
        } else {
          throw new TypeError('Expected "' + token.name + '" to be defined')
        }
      }

      if (isarray(value)) {
        if (!token.repeat) {
          throw new TypeError('Expected "' + token.name + '" to not repeat, but received "' + value + '"')
        }

        if (value.length === 0) {
          if (token.optional) {
            continue
          } else {
            throw new TypeError('Expected "' + token.name + '" to not be empty')
          }
        }

        for (var j = 0; j < value.length; j++) {
          segment = encodeURIComponent(value[j])

          if (!matches[i].test(segment)) {
            throw new TypeError('Expected all "' + token.name + '" to match "' + token.pattern + '", but received "' + segment + '"')
          }

          path += (j === 0 ? token.prefix : token.delimiter) + segment
        }

        continue
      }

      segment = encodeURIComponent(value)

      if (!matches[i].test(segment)) {
        throw new TypeError('Expected "' + token.name + '" to match "' + token.pattern + '", but received "' + segment + '"')
      }

      path += token.prefix + segment
    }

    return path
  }
}

/**
 * Escape a regular expression string.
 *
 * @param  {String} str
 * @return {String}
 */
function escapeString (str) {
  return str.replace(/([.+*?=^!:${}()[\]|\/])/g, '\\$1')
}

/**
 * Escape the capturing group by escaping special characters and meaning.
 *
 * @param  {String} group
 * @return {String}
 */
function escapeGroup (group) {
  return group.replace(/([=!:$\/()])/g, '\\$1')
}

/**
 * Attach the keys as a property of the regexp.
 *
 * @param  {RegExp} re
 * @param  {Array}  keys
 * @return {RegExp}
 */
function attachKeys (re, keys) {
  re.keys = keys
  return re
}

/**
 * Get the flags for a regexp from the options.
 *
 * @param  {Object} options
 * @return {String}
 */
function flags (options) {
  return options.sensitive ? '' : 'i'
}

/**
 * Pull out keys from a regexp.
 *
 * @param  {RegExp} path
 * @param  {Array}  keys
 * @return {RegExp}
 */
function regexpToRegexp (path, keys) {
  // Use a negative lookahead to match only capturing groups.
  var groups = path.source.match(/\((?!\?)/g)

  if (groups) {
    for (var i = 0; i < groups.length; i++) {
      keys.push({
        name: i,
        prefix: null,
        delimiter: null,
        optional: false,
        repeat: false,
        pattern: null
      })
    }
  }

  return attachKeys(path, keys)
}

/**
 * Transform an array into a regexp.
 *
 * @param  {Array}  path
 * @param  {Array}  keys
 * @param  {Object} options
 * @return {RegExp}
 */
function arrayToRegexp (path, keys, options) {
  var parts = []

  for (var i = 0; i < path.length; i++) {
    parts.push(pathToRegexp(path[i], keys, options).source)
  }

  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options))

  return attachKeys(regexp, keys)
}

/**
 * Create a path regexp from string input.
 *
 * @param  {String} path
 * @param  {Array}  keys
 * @param  {Object} options
 * @return {RegExp}
 */
function stringToRegexp (path, keys, options) {
  var tokens = parse(path)
  var re = tokensToRegExp(tokens, options)

  // Attach keys back to the regexp.
  for (var i = 0; i < tokens.length; i++) {
    if (typeof tokens[i] !== 'string') {
      keys.push(tokens[i])
    }
  }

  return attachKeys(re, keys)
}

/**
 * Expose a function for taking tokens and returning a RegExp.
 *
 * @param  {Array}  tokens
 * @param  {Array}  keys
 * @param  {Object} options
 * @return {RegExp}
 */
function tokensToRegExp (tokens, options) {
  options = options || {}

  var strict = options.strict
  var end = options.end !== false
  var route = ''
  var lastToken = tokens[tokens.length - 1]
  var endsWithSlash = typeof lastToken === 'string' && /\/$/.test(lastToken)

  // Iterate over the tokens and create our regexp string.
  for (var i = 0; i < tokens.length; i++) {
    var token = tokens[i]

    if (typeof token === 'string') {
      route += escapeString(token)
    } else {
      var prefix = escapeString(token.prefix)
      var capture = token.pattern

      if (token.repeat) {
        capture += '(?:' + prefix + capture + ')*'
      }

      if (token.optional) {
        if (prefix) {
          capture = '(?:' + prefix + '(' + capture + '))?'
        } else {
          capture = '(' + capture + ')?'
        }
      } else {
        capture = prefix + '(' + capture + ')'
      }

      route += capture
    }
  }

  // In non-strict mode we allow a slash at the end of match. If the path to
  // match already ends with a slash, we remove it for consistency. The slash
  // is valid at the end of a path match, not in the middle. This is important
  // in non-ending mode, where "/test/" shouldn't match "/test//route".
  if (!strict) {
    route = (endsWithSlash ? route.slice(0, -2) : route) + '(?:\\/(?=$))?'
  }

  if (end) {
    route += '$'
  } else {
    // In non-ending mode, we need the capturing groups to match as much as
    // possible by using a positive lookahead to the end or next path segment.
    route += strict && endsWithSlash ? '' : '(?=\\/|$)'
  }

  return new RegExp('^' + route, flags(options))
}

/**
 * Normalize the given path string, returning a regular expression.
 *
 * An empty array can be passed in for the keys, which will hold the
 * placeholder key descriptions. For example, using `/user/:id`, `keys` will
 * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.
 *
 * @param  {(String|RegExp|Array)} path
 * @param  {Array}                 [keys]
 * @param  {Object}                [options]
 * @return {RegExp}
 */
function pathToRegexp (path, keys, options) {
  keys = keys || []

  if (!isarray(keys)) {
    options = keys
    keys = []
  } else if (!options) {
    options = {}
  }

  if (path instanceof RegExp) {
    return regexpToRegexp(path, keys, options)
  }

  if (isarray(path)) {
    return arrayToRegexp(path, keys, options)
  }

  return stringToRegexp(path, keys, options)
}

},{"isarray":3}],6:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}]},{},[2]);
